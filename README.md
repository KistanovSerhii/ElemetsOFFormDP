# ElemetsOfFormDynamicP
1С Elemets of Form with dynamic properties / Динамическая установка свойств элементам формы

# (Пример) Задача: 
1. Все реквизиты формы справочника Сотрудники НЕ должны быть доступны для редактирования
и только те пользователи которые входят в группу доступа "ОграниченныйДоступСправочникСотрудники
могут менять значение реквизита Организация и команда "Записать и закрыть"!

2. Пользователи входящие в группу доступа "ОграниченныйДоступСправочникСотрудникиРасширенный" должны
могут менять значение реквизита Организация и команда "Записать и закрыть", а также остальные реквизиты должны быть
доступны, но только на просмотр (имеется ввиду: ТолькоПросмотр = Истина, Доступность = Истина)!

3. Пользователи входящие в группу доступа "Администраторы" должны не должны иметь ограничений!

# Внедрение:

	#Область НовыеЗнчДляСвойствЭлементовФормы

	Процедура НовыеЗнчДляСвойствЭлементовФормы()
    	// Имена стандартных команд формы: ФормаЗаписатьИЗакрыть, ФормаЗаписать

	// Описание свойств +++
	свойстваЭлементовОбщее	= Новый Структура("Свойство,Значение", "Доступность", Ложь);
	свойстваЭлементов 		= Новый Массив;	
	свойстваЭлементов.Добавить(	Новый Структура("Имя,Свойство,Значение", "ФормаЗаписатьИЗакрыть", "Доступность", Истина) );
	свойстваЭлементов.Добавить(	Новый Структура("Имя,Свойство,Значение", "ГоловнаяОрганизация", "Доступность", Истина) );
	свойстваЭлементов.Добавить(	Новый Структура("Имя,Свойство,Значение", "ФИО", "ТолькоПросмотр", Истина) );
	// Описание свойств ---

	УстановитьПривилегированныйРежим(Истина);
	
	//Получаем ссылку на внешнюю обработку добавленную в "Дополнительные отчеты и обработки" +++
	внешняяОбработкаИмя    = "ДинамическоеСвойствоЭлементаФормы";
	внешняяОбработкаСсылка = Справочники.ДополнительныеОтчетыИОбработки.НайтиПоРеквизиту("ИмяОбъекта", внешняяОбработкаИмя);
	внешняяОбработкаОбъект = ДополнительныеОтчетыИОбработки.ОбъектВнешнейОбработки(внешняяОбработкаСсылка);
	// Получаем ссылку на внешнюю обработку добавленную в "Дополнительные отчеты и обработки" ---
	
	видыИТипы = внешняяОбработкаОбъект.НаборВидовИТиповЭлементовФормы();
	внешняяОбработкаОбъект.УстановитьСвойствоЭлементаФормы(ЭтаФорма, видыИТипы, свойстваЭлементов, свойстваЭлементовОбщее);
	
	УстановитьПривилегированныйРежим(Ложь);
	
	КонецПроцедуры

	#КонецОбласти

# (Дополнительно) код проверки вхождения в Группу доступа:
//(Как правило управлять значением свойства элемента надо на основании вхождения пользователя в Грпуппу доступа)

	#Область ТекущийПользовательДобавленВГруппыДоступа

	// мГруппыДоступа - Массив ИЗ Строка - Наименование ГруппыДоступа
	//
	// Возврат Булево
	Функция ТекущийПользовательДобавленВГруппыДоступа(мГруппыДоступа) Экспорт

	УстановитьПривилегированныйРежим(Истина);
	Запрос = Новый Запрос;
	Запрос.Текст = 
	
	"Выбрать 
	|	Пользователь 
	|ИЗ 
	|	Справочник.ГруппыДоступа.пользователи
	|Где
	|	Пользователь = &ТекущийПользователь
	|	И Ссылка.Профиль.Наименование В (&ИмяПрофиля)";
	
	Запрос.УстановитьПараметр("ТекущийПользователь",	ПараметрыСеанса.ТекущийПользователь);
	Запрос.УстановитьПараметр("ИмяПрофиля", 			мГруппыДоступа);
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Возврат (Выборка.Следующий() И Выборка.Пользователь <> "");
		
	КонецФункции

	#КонецОбласти


# (Дополнительно) Использование Кода проверки вхождения:

	мГруппыДоступа = Новый Массив;
	мГруппыДоступа.Добавить("ОграниченныйДоступСправочникСотрудники");
	
	// Доступ разрешен исключительно пользователям добавленным в профиль из массива "мГруппыДоступа"
	//, рекомендую добавить еще профиль администраторов (что бы с правами администратора доступ тоже был разрешен)
	доступРазрешен = НЕ ТекущийПользовательДобавленВГруппыДоступа(мГруппыДоступа);

